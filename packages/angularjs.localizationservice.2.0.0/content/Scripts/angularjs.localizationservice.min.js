"use strict";
/*
 * An AngularJS Localization Service
 *
 * Based on code by Jim Lavin <http://codingsmackdown.tv>, modified by Petr Kadlec <mormegil@centrum.cz>
 */
angular.module("localization",[]).provider("localize",function(){function r(e,n){for(var r=1;r<n.length;++r){e=e.replace(t[r],n[r])}return e}var e={};e["resourceUrl"]="/i18n/resources-locale_<>.js";e["language"]=null;var t=[];for(var n=1;n<10;++n){t[n]=new RegExp("\\$"+n,"g")}e["$get"]=["$http","$rootScope","$window","$interpolate",function(t,n,i,s){function o(e,n,r){t({method:"GET",url:e.resourceUrl.replace("<>",n),cache:true}).success(r)}var u={resourceUrl:e.resourceUrl,language:e.language||i.navigator.userLanguage||i.navigator.language,dictionary:[],defaultDictionary:[],parsers:[],setLanguage:function(e){u.dictionary=[];u.parsers=[];u.language=e;u.loadResources()},getLocalizedString:function(e){var t=u.dictionary[e]||u.defaultDictionary[e]||"";t=r(t,arguments);return t},getLocalizedParsedString:function(e){var t=u.dictionary[e]||u.defaultDictionary[e]||"";var n=u.parsers[t];if(n===undefined){n=s(t);u.parsers[t]=n}var i={args:arguments};t=n(i);t=r(t,arguments);return t},loadResources:function(){o(u,u.language,u.resourceFileLoaded)},resourceFileLoaded:function(e){u.dictionary=e||[];n.$broadcast("localizeResourcesUpdates")}};o(u,"default",function(e){u.defaultDictionary=e||[]});u.loadResources();return u}];return e}).filter("i18n",["localize",function(e){return function(){return e.getLocalizedString.apply(e,arguments)}}]).filter("i18nparsed",["localize",function(e){return function(){return e.getLocalizedParsedString.apply(e,arguments)}}]).filter("plural",["$locale",function(e){return function(){var t=this.args[1];var n=arguments[1];return n[e.pluralCat(t)||"other"]}}]).directive("i18n",["localize",function(e){var t={restrict:"EAC",updateText:function(t,n){var r=n.split("|");if(r.length>=1){var i=e.getLocalizedString(r[0]);if(i!==null&&i!==undefined&&i!==""){if(r.length>1){for(var s=1;s<r.length;s++){var o="{"+(s-1)+"}";i=i.replace(o,r[s])}}t.text(i)}}},link:function(e,n,r){e.$on("localizeResourcesUpdates",function(){t.updateText(n,r.i18n)});r.$observe("i18n",function(){t.updateText(n,r.i18n)})}};return t}])